<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.0/css/dataTables.dataTables.css" />
    <script src="https://cdn.datatables.net/2.0.0/js/dataTables.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.0/css/dataTables.dataTables.css" />
    <script src="https://cdn.datatables.net/2.0.0/js/dataTables.js"></script>
</head>

<body>
    <form id="Myform">
        <label>FirstName</label>
        <input type="text" name="FirstName" id="FirstName">
        <label>LastName</label>
        <input type="text" name="LastName" id="LastName">
        <input type="submit" name="submit" id="submit" value="submit">
        <input type="button" name="update" id="update" value="update">

        <table id="Myform1">
            <thead>
                <tr>
                    <th>FirstName</th>
                    <th>LastName</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>

            </tbody>
        </table>
    </form>
    <script>
        var allData = [];
        var counter = 0;
        $(document).ready(function () {
            $('#Myform').on('click', '#submit', function (e) {
                e.preventDefault();
                var Formdata = {};
                var FirstName = $('#FirstName').val();
                var LastName = $('#LastName').val();
                Formdata['FirstName'] = FirstName;
                Formdata['LastName'] = LastName;
                Formdata['counter'] = counter;
                Formdata['Deleted'] = false;
                allData.push(Formdata);
                counter++;
                document.getElementById("Myform").reset(); // Reset the form
                table();
                console.log(allData);
            });

            function table() {
                var table = $('#Myform1').DataTable();
                table.clear().draw();
                $.each(allData, function (index, object) {
                    if (object.Deleted == false) {
                        var row = table.row.add([object.FirstName, object.LastName, '<input type="button" class="edit" value="Edit"><input type="button" class="Delete" value ="Delete">']).draw().node();
                        $(row).attr('counter', object.counter);
                    }
                })


            }
            $(document).on('click', '.edit', function () {
                debugger
                var Countervalue = parseInt($(this).closest('tr').attr('counter'));
                var RowIndex = allData.findIndex(function (element) {
                    return element.counter == Countervalue; // return statement is important
                })
                console.log(RowIndex)

                var FirstName = $('#FirstName')
                var LastName = $('#LastName')

                var ObjectValueFirstName = allData[RowIndex].FirstName;
                var ObjectValueLastName = allData[RowIndex].LastName;

                FirstName.val(ObjectValueFirstName);
                LastName.val(ObjectValueLastName);



                $(document).on('click', '#update', function () {
                    var updateNewValueFirstName = $('#FirstName').val();
                    var updateNewValueLastName = $('#LastName').val();

                    allData[RowIndex].FirstName = updateNewValueFirstName;
                    allData[RowIndex].LastName = updateNewValueLastName;

                    document.getElementById("Myform").reset(); // Reset the form

                    table();
                })



            });

            $(document).on('click', '.Delete', function () {
                debugger
                var RowDeleted = parseInt($(this).closest('tr').attr('counter'));
                var RowIndexDelete = allData.findIndex(function(element)
                {
                    return element.counter == RowDeleted;
                })
                allData[RowIndexDelete].Deleted =true;
                table();
            });
        });
    </script>
</body>

</html>