<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DataTables Example</title>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
<style>
  /* Optional: Add custom styling for the table */
  #myTable {
    border-collapse: collapse;
    width: 100%;
  }
  #myTable th, #myTable td {
    border: 1px solid black;
    padding: 8px;
    text-align: left;
  }
</style>
</head>
<body>

<table id="myTable">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Edit</th>
      <th>Delete</th>
    </tr>
  </thead>
  <tbody>
    <!-- Table body will be populated dynamically by DataTables -->
  </tbody>
</table>

<!-- Modal for editing and inserting -->
<div id="editModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2 id="modalTitle">Add Row</h2>
    <input type="text" id="editColumn1" placeholder="Enter value for Column 1">
    <input type="text" id="editColumn2" placeholder="Enter value for Column 2">
    <button id="saveEdit">Save</button>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script>
  // Sample array data
  var dataArray = [
    { column1: "Data 1A", column2: "Data 1B" },
    { column1: "Data 2A", column2: "Data 2B" },
    { column1: "Data 3A", column2: "Data 3B" }
  ];

  $(document).ready(function() {
    // Initialize DataTable
    var table = $('#myTable').DataTable();

    // Populate DataTable with array data
    dataArray.forEach(function(item) {
      var rowNode = table.row.add([item.column1, item.column2, '<button class="editBtn">Edit</button>', '<button class="deleteBtn">Delete</button>']).draw(false).node();
      $(rowNode).attr('data-index', table.rows().count() - 1); // Set a data attribute to keep track of the index
    });

    // Edit button click handler
    $('#myTable').on('click', '.editBtn', function() {
      var rowIndex = $(this).closest('tr').attr('data-index');
      var rowData = dataArray[rowIndex];

      // Populate modal with current row data
      $('#modalTitle').text('Edit Row');
      $('#editColumn1').val(rowData.column1);
      $('#editColumn2').val(rowData.column2);

      // Show the modal
      $('#editModal').show().attr('data-index', rowIndex);
    });

    // Insert button click handler
    $('#insertBtn').click(function() {
      // Reset modal fields
      $('#modalTitle').text('Add Row');
      $('#editColumn1, #editColumn2').val('');

      // Show the modal
      $('#editModal').show().removeAttr('data-index');
    });

    // Close modal when the close button or outside the modal is clicked
    $('.close').click(function() {
      $('#editModal').hide();
    });

    $(window).click(function(event) {
      if (event.target == $('#editModal')[0]) {
        $('#editModal').hide();
      }
    });

    // Save edited/inserted data
    $('#saveEdit').click(function() {
      var rowIndex = $('#editModal').attr('data-index');
      var newData = {
        column1: $('#editColumn1').val(),
        column2: $('#editColumn2').val()
      };

      if (rowIndex === undefined) {
        // Insert new row
        dataArray.push(newData);
        var rowNode = table.row.add([newData.column1, newData.column2, '<button class="editBtn">Edit</button>', '<button class="deleteBtn">Delete</button>']).draw(false).node();
        $(rowNode).attr('data-index', table.rows().count() - 1); // Set a data attribute to keep track of the index
      } else {
        // Edit existing row
        dataArray[rowIndex] = newData;
        table.row(rowIndex).data([newData.column1, newData.column2, '<button class="editBtn">Edit</button>', '<button class="deleteBtn">Delete</button>']).draw(false);
      }

      // Close the modal
      $('#editModal').hide();
    });

    // Delete button click handler
    $('#myTable').on('click', '.deleteBtn', function() {
      var rowIndex = $(this).closest('tr').attr('data-index');

      // Prompt user for confirmation before deleting
      if (confirm("Are you sure you want to delete this row?")) {
        // Remove row from DataTable and dataArray
        table.row(rowIndex).remove().draw(false);
        dataArray.splice(rowIndex, 1);
      }
    });
  });
</script>

</body>
</html>
