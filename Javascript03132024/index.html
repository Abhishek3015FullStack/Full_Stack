<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.0/css/dataTables.dataTables.css" />
    <script src="https://cdn.datatables.net/2.0.0/js/dataTables.js"></script>
    <style>
        * {
            margin: 0px;
            padding: 0px;
            box-sizing: border-box;
        }

        #popup {
            background-color: white;
            /* min-height: 500px;
                min-width: 500px; */
            opacity: 0;
            box-shadow: 2px 2px 2px grey;

            width: 100%;
            position: absolute;
            z-index: -1;
            /* Make sure the pop-up appears on top of other elements */
            display: none;
        }

        .inputStatic {
            margin: 0px 6px 8px 0px;
        }
    </style>
</head>

<body>
    <form id="myForm">
        <div>
            <input type="button" id="openPopup" value="addStudent">
        </div>
        <div id="popup" class="d-flex justify-content-center align-items-center">
            <div class="container mt-4 mb-5">
                <div class="row">
                    <div class="col-lg-4 p-3">
                        <label for="First Name">First Name</label>
                        <input type="text" id="First_Name" name="First_Name" class="form-control">
                    </div>
                    <div class="col-lg-4 p-3">
                        <label for="Last_Name">Last Name</label>
                        <input type="text" id="Last_Name" name="Last_Name" class="form-control">
                    </div>
                    <div class="col-lg-4 p-3">
                        <label for="Date_of_Birth">Date of Birth</label>
                        <input type="month" id="Date_of_Birth" name="Date_of_Birth" class="form-control">
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-4 p-3">
                        <label for="Email">Email</label>
                        <input type="email" id="Email" class="form-control" name="Email">
                    </div>
                    <div class="col-lg-4 p-3">
                        <label for="Address">Address</label>
                        <input type="text" id="Address" class="form-control" name="Address">
                    </div>
                    <div class="col-lg-4 p-3">
                        <label for="Graduation">Graduation</label>
                        <input type="month" id="Graduation" class="form-control" name="Graduation">
                    </div>

                </div>
                <div class="mt-5">
                    <div>
                        <h2>Education </h2>
                    </div>
                    <div class="d-flex justify-content-end"><input type="button" id="AddDynamicButton" value="ADD">
                    </div>

                </div>
                <table class="mt-5" id="DynamicTable">
                    <thead>
                        <tr>
                            <th>Degree</th>
                            <th>School/Degree</th>
                            <th>Start Date</th>
                            <th>Passout year</th>
                            <th>Percentage</th>
                            <th>Backlog</th>
                            <th>Action</th>

                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="text" id="InputStatic1" class="inputStatic"></td>
                            <td><input type="text" id="InputStatic2" class="inputStatic"></td>
                            <td><input type="month" id="InputStatic3" class="inputStatic"></td>
                            <td><input type="month" id="InputStatic4" class="inputStatic"></td>
                            <td><input type="text" id="InputStatic5" class="inputStatic"></td>
                            <td><input type="text" id="InputStatic6" class="inputStatic"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><input type="text" id="InputStatic7" class="inputStatic"></td>
                            <td><input type="text" id="InputStatic8" class="inputStatic"></td>
                            <td><input type="month" id="InputStatic9" class="inputStatic"></td>
                            <td><input type="month" id="InputStatic10" class="inputStatic"></td>
                            <td><input type="text" id="InputStatic11" class="inputStatic"></td>
                            <td><input type="text" id="InputStatic12" class="inputStatic"></td>
                            <td></td>
                        </tr>
                    </tbody>

                </table>
                <div class="d-flex justify-content-center mt-2 mb-2"><input type="submit" id="submit" value="submit">
                <div class="d-flex justify-content-center mt-2 mb-2 "><input type="button" id="update" value="update"></div>
                </div>
            </div>
        </div>
        <div>
            <table id="OutsideTable">
                <thead>
                    <tr>
                        <th>First_Name</th>
                        <th>Last_Name</th>
                        <th>Date_of_Birth</th>
                        <th>Email</th>
                        <th>Address</th>
                        <th>Graduation</th>
                        <th>Action</th>
                    </tr>
                </thead>
            </table>
        </div>

    </form>
    <script>
        var open = 0; // Initialize open variable outside the event handler
        var counter = 0;
        var counter2 = 0
        var formData = [];
        var table = $('#OutsideTable').DataTable();
        $(document).ready(function () {


            $('#openPopup').on('click', function () {
                $('#submit').css({"display":"block"});
                $('#update').css({"display":"none"});
                if (open === 0) {
                    open = 1;
                    $('#popup').css({ "opacity": "1", "z-index": "1" });
                    $('#myForm')[0].reset();
                } else {
                    open = 0;
                    $('#popup').css({ "opacity": "0", "z-index": "-1" });
                    $('#myForm')[0].reset();

                }
            });
            $('#AddDynamicButton').on('click', function () {
                var table2 = $('#DynamicTable');
                var NewRow = $('<tr>')
                NewRow.append('<td> <input type="text" id="Dynamic' + counter + '" class="dynamic"></td>')
                counter++;
                NewRow.append('<td><input type="text" id="Dynamic' + counter + '" class="dynamic"></td>')
                counter++;
                NewRow.append('<td><input type="month" id="Dynamic' + counter + '" class=" dynamic"></td>')
                counter++;
                NewRow.append('<td><input type="month" id="Dynamic' + counter + '" class=" dynamic"></td>')
                counter++;
                NewRow.append('<td><input type="text" id="Dynamic' + counter + '" class=" dynamic"></td>')
                counter++;
                NewRow.append('<td><input type="text" id="Dynamic' + counter + '" class=" dynamic"></td>')
                NewRow.append('<td><input type="button" class="Delete dynamic" value="Delete"> ')
                counter++;
                table2.append(NewRow);
            })

            $('#myForm').on('click', '#submit', function (e) {
                var rowData = {};
                e.preventDefault();
                var First_Name = $('#First_Name').val();
                var Last_Name = $('#Last_Name').val();
                var Date_of_Birth = $('#Date_of_Birth').val();
                var Email = $('#Email').val();
                var Address = $('#Address').val();
                var Graduation = $('#Graduation').val();
                var InputStatic1 = $('#InputStatic1').val();
                var InputStatic2 = $('#InputStatic2').val();
                var InputStatic3 = $('#InputStatic3').val();
                var InputStatic4 = $('#InputStatic4').val();
                var InputStatic5 = $('#InputStatic5').val();
                var InputStatic6 = $('#InputStatic6').val();
                var InputStatic7 = $('#InputStatic7').val();
                var InputStatic8 = $('#InputStatic8').val();
                var InputStatic9 = $('#InputStatic9').val();
                var InputStatic10 = $('#InputStatic10').val();
                var InputStatic11 = $('#InputStatic11').val();
                var InputStatic12 = $('#InputStatic12').val();
                $('.dynamic').each(function () {
                    var id = $(this).attr('id');
                    var val = $(this).val();
                    rowData[id] = val
                })
                rowData['First_Name'] = First_Name
                rowData['Last_Name'] = Last_Name
                rowData['Date_of_Birth'] = Date_of_Birth
                rowData['Email'] = Email;
                rowData['Address'] = Address
                rowData['Graduation'] = Graduation;
                rowData['InputStatic1'] = InputStatic1;
                rowData['InputStatic2'] = InputStatic2;
                rowData['InputStatic3'] = InputStatic3
                rowData['InputStatic4'] = InputStatic4
                rowData['InputStatic5'] = InputStatic5
                rowData['InputStatic6'] = InputStatic6
                rowData['InputStatic7'] = InputStatic7
                rowData['InputStatic8'] = InputStatic8
                rowData['InputStatic9'] = InputStatic9
                rowData['InputStatic10'] = InputStatic10
                rowData['InputStatic11'] = InputStatic11
                rowData['InputStatic12'] = InputStatic12
                rowData['Deleted'] = false
                rowData['counter2'] = counter2
                formData.push(rowData)
                counter2++;
                console.log(formData);

                $('#popup').css({ "opacity": "0", "z-index": "-1" });
                open = 0;
                table1()
                $('#myForm')[0].reset();
                $('.dynamic').remove();
                counter= 0;

            })
            function table1() {
                table.clear().draw();
                $.each(formData, function (index, object) {
                    var row = table.row.add([object.First_Name, object.Last_Name, object.Date_of_Birth, object.Email, object.Address, object.Graduation, '<input type="button" value="edit" class="Edit1">']).draw().node();
                    $(row).attr('counter2', object.counter2)

                })
            }

            $(document).on('click', '.Edit1', function () {
                $('#openPopup').click();
                $('.dynamic').remove();
                $('#submit').css({"display":"none"});
                $('#update').css({"display":"block"});

                var clickTrButton = $(this).closest('tr').attr('counter2');

                var findindexWhichClick = formData.findIndex(function (element) {
                    return element.counter2 == clickTrButton
                });
                var SetValuesFromObject = formData[findindexWhichClick];
                $('#First_Name').val(SetValuesFromObject.First_Name);
                $('#Last_Name').val(SetValuesFromObject.Last_Name);
                $('#Date_of_Birth').val(SetValuesFromObject.Date_of_Birth);
                $('#Email').val(SetValuesFromObject.Email);
                $('#Address').val(SetValuesFromObject.Address);
                $('#Graduation').val(SetValuesFromObject.Graduation)
                $('#InputStatic1').val(SetValuesFromObject.InputStatic1);
                $('#InputStatic2').val(SetValuesFromObject.InputStatic2);
                $('#InputStatic3').val(SetValuesFromObject.InputStatic3);
                $('#InputStatic4').val(SetValuesFromObject.InputStatic4);
                $('#InputStatic5').val(SetValuesFromObject.InputStatic5);
                $('#InputStatic6').val(SetValuesFromObject.InputStatic6);
                $('#InputStatic7').val(SetValuesFromObject.InputStatic7);
                $('#InputStatic8').val(SetValuesFromObject.InputStatic8);
                $('#InputStatic9').val(SetValuesFromObject.InputStatic9);
                $('#InputStatic10').val(SetValuesFromObject.InputStatic10);
                $('#InputStatic11').val(SetValuesFromObject.InputStatic11);
                $('#InputStatic12').val(SetValuesFromObject.InputStatic12);

                
                var NumberOfDynamicCount = countDynamicKeys(SetValuesFromObject);
                console.log(NumberOfDynamicCount);

                var countOfIteration = NumberOfDynamicCount/6
                for(var i = 0;i<countOfIteration;i++)
                {
                    counter=0;
                    $('#AddDynamicButton').click();
                }
                document.querySelectorAll('.dynamic').forEach(function (element) {

                    var id = element.id;
                    if (SetValuesFromObject.hasOwnProperty(id)) {
                        element.value = SetValuesFromObject[id];
                    }
                });
               



            });

            function countDynamicKeys(obj) {
                
                    let dynamicKeyCount = 0;
                    for (let key in obj) {
                        if (key.startsWith('Dynamic')) { 
                            dynamicKeyCount++;
                        }
                    }
                    return dynamicKeyCount;
                }
        });


    </script>
</body>

</html>