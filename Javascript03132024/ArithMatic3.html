<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.0/css/dataTables.dataTables.css" />
    <script src="https://cdn.datatables.net/2.0.0/js/dataTables.js"></script>
    <style>
        #popup {
            z-index: -1;
            opacity: 0;
            background-color: aquamarine;
            height: auto;
            width: 40%;
            position: absolute;
            display: none;
            top: 20%;
            left: 30%;
        }
    </style>
</head>

<body>
    <div id="popup">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 justify-content-center align-items-center m-4">
                    <label>input1</label>
                    <input type="number" name="input1" id="input1" class="form-control">
                    <span id="input1validationMessage"></span>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 m-4">
                    <label>input 2</label>
                    <input type="number" name="input2" id="input2" class="form-control">
                    <span id="input2validationMessage"></span>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 m-4">
                    <label>addition</label>
                    <input type="checkbox" name="Operation" id="addition" value="addition" class="form-checked">

                    <label>Substraction</label>
                    <input type="checkbox" name="Operation" id="Substraction" value="Substraction">

                    <label>addition</label>
                    <input type="checkbox" name="Operation" id="Multiplication" value="Multiplication">

                    <label>addition</label>
                    <input type="checkbox" name="Operation" id="Division" value="Division">
                </div>
            </div>
            <input type="button" name="dynamic" id="dynamic" value="dynamic">
            <div id="Dynamic">
                <table id="dynamicTable">
                    <thead>
                        <tr>
                            <th>Dynamic 1</th>
                            <th>Dynamic 2</th>
                            <th>Dynamic 3</th>
                            <th>Dynamic 4</th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
        </div>
        <input type="button" name="closebutton" id="closebutton" value="closebutton" class="btn btn-danger">
        <input type="button" name="submit" id="submit" value="submit" class="btn btn-primary ">
        <input type="button" name="update" id="update" value="update" class="btn btn-light">
    </div>

    <table id="Mytable">
        <thead>
            <tr>
                <th>Input 1</th>
                <th>Input 2</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
    <input type="button" name="show_the_pop" id="show_the_pop" value="show_the_pop">
    <script>
        var Mytable = $('#Mytable').DataTable();
        var userData = [];
        var addition = 0;
        var Substraction = 0;
        var Multiplication = 0;
        var Division = 0;
        var dynamicCounter = 0

        $(document).ready(function () {
            let currentDate = new Date();
            let currentYear = currentDate.getFullYear();
            var a= "2000";
            debugger
            var date1 = new Date(a)
            var age = currentYear - a
            console.log(age)


            $('#show_the_pop').on('click', function () {
                $('#popup').css({ "z-index": "1", "opacity": "1", "display": "block" })
            })
            $('#closebutton').on('click', function () {
                $('#popup').css({ "z-index": "-1", "opacity": "0", "display": "none" });
            })
            $(document).on('click', '#submit', function (e) {
                e.preventDefault();
                var a = validationfunction()
                var b = validationfunction2()
                if (a == true && b == true) {
                    var rowData = {};
                    var input1 = $('#input1').val();
                    var input2 = $('#input2').val();
                    var operation = document.querySelectorAll('input[name="Operation"]:checked')
                    var valuesOfOperation = []
                    var values = {}
                    operation.forEach(function (element) {
                        var id = element.id;
                        var value = element.value;
                        values[id] = value
                    })
                    valuesOfOperation.push(values)
                    rowData['operation'] = valuesOfOperation;
                    rowData['input1'] = input1;
                    rowData['input2'] = input2;
                    valuesOfOperation.forEach(function (index, element) {
                        var obj = valuesOfOperation[element]
                        var keys = Object.keys(obj)
                        console.log(obj)
                        keys.forEach(function (element) {

                            if (element == "addition") {
                                addition = parseInt(input1) + parseInt(input2)
                            }
                            else if (element == "Substraction") {
                                Substraction = parseInt(input1) - parseInt(input2)
                            }
                            else if (element == "Multiplication") {
                                Multiplication = parseInt(input1) * parseInt(input2)
                            }
                            else if (element == "Division") {
                                Division = parseInt(input1) / parseInt(input2)
                            }
                        })
                    })
                    var DataArray = [];
                    var counterforArray = 0;
                    var Data = document.querySelectorAll('.DynamicData')
                    Data.forEach(function (element, index) {
                        debugger
                        var id = element.id;
                        var value = element.value
                        counterforArray++;
                        var DynamicDataobject = {
                            id: id,
                            value: value
                        }
                        DataArray.push(DynamicDataobject)
                    })
                    

                    for (var i = 0; i < Data.length; i++) {
                        var newDataObject = {};

                        for (var j = 0; j < 4 ;j++) {
                            var element = Data[i + j];
                            var id = element.id;
                            var value = element.value;
                            newDataObject[id] = value;
                        }
                        

                        DataArray.push(newDataObject);
                    }

                    rowData['DataOfArray'] = DataArray

                    rowData['addition'] = addition
                    rowData['Substraction'] = Substraction
                    rowData['Multiplication'] = Multiplication
                    rowData['Division'] = Division
                    userData.push(rowData)
                    console.log(userData)
                    dynamicCounter = 0;
                    $('#closebutton').click();
                    tableForm()

                }
                else {

                }
            });
            $(document).on('click', '#dynamic', function () {

                var row = $('<tr>')
                row.append('<td><input type="text" name="dynamicField" id="Dyamic_Name_' + dynamicCounter + '" class="DynamicData"></td>');
                row.append('<td><input type="text" name="dynamicField" id="Dyamic_First_' + dynamicCounter + '" class="DynamicData"></td>');
                row.append('<td><input type="text" name="dynamicField" id="Dyamic_Last_' + dynamicCounter + '" class="DynamicData"></td>');
                row.append('<td><input type="text" name="dynamicField" id="Dyamic_City_' + dynamicCounter + '" class="DynamicData"></td>');
                dynamicCounter++;
                $('#dynamicTable').append(row)
            })

            function tableForm() {
                Mytable.clear().draw();
                $.each(userData, function (index, object) {
                    var row = Mytable.row.add([object.input1, object.input2, '<input type="button" name="showDataTable" value="showDataTable" class="showDataTable">']).draw().node();
                    $(row).attr('input1', object.input1)
                })
            }
            $(document).on('click', '.showDataTable', function () {
                debugger
                var rowClickIndex = $(this).closest('tr').attr('input1')
                var rows = $(this).closest('tr')
                var RowFindValue = userData.findIndex(function (element) {
                    return element.input1 == rowClickIndex;

                })
         

                var a = userData[RowFindValue].DataOfArray;
       
                console.log(a);
                var tableDyanicgenerated = $('<table>').attr({ "id": "mytable" })
                rows.after(tableDyanicgenerated)

                var dataTable = tableDyanicgenerated.DataTable({
                    width: "100%",
                    paging: false,
                    searching: false,
                    info: false,
                    autoWidth: false,
                    data: a,
                    columns: [
                        { data: 'Dyamic_City_0', title: 'Degree' },
                        { data: 'Dyamic_First_0', title: 'Degree' },
                        { data: 'Dyamic_Last_0', title: 'Degree' },
                        { data: 'Dyamic_Name_0', title: 'Degree' },
                    ]
                });

            });
            function validationfunction() {
                debugger
                var flag = 0
                var a = $('#input1').val();
                var avalidation = $('#input1validationMessage')
                if (a != "") {
                    avalidation.text(" ")
                    flag = 0
                }
                else {
                    avalidation.text("This is required Fields");
                    avalidation.css({ "color": "red" });
                    flag = 1

                }

                if (flag == 1) {
                    return false;

                }
                else {
                    return true;
                }
            }
            function validationfunction2() {
                var flag = 0
                debugger
                var a = $('#input2').val();
                var b = $('#input2validationMessage');
                if (a != "") {
                    b.text(" ")
                    flag = 0
                }
                else {
                    b.text("this is the required field")
                    b.css({ "color": "red" })
                    flag = 1
                }
                if (flag == 0) {
                    return true;
                }
                else {
                    return false
                }
            }

        })
    </script>
</body>

</html>