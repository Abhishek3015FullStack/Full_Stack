<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="Jquery.js"></script>
    <link rel="stylesheet" href="DataTables.css">
    <script src="DataTables.js"></script>
    <link  rel="stylesheet" href="bootstrap-5.3.3-dist/css/bootstrap.css">
    <script src="bootstrap-5.3.3-dist/js/bootstrap.js"></script>
    <style>
        #popup
        {
            z-index: -1;
            opacity: 0;
            display: none;
            position: absolute;
            background-color: aqua;
            left: 20%;
            width: 50%;

        }
    </style>
</head>
<body>
    <div>
        <input type="button" name="showPopup" id="showPopup" value="showPopup">
    </div>
    <div id="popup">
        <input type="text" name="firstname" id="firstname">
        <input type="button" name="DynamicGenerate" id="DynamicGenerate" value="ADD">
        <table id="FruitDynamic">
                <thead>
                        <tr>
                            <th>FruitName</th>
                            <th>rate</th>
                            <th>Quantity</th>
                            <th>Total</th>
                            <th>Action</th>
                        </tr>
                </thead>
        </table>
        <div>
            <input type="submit" name="submit" id="submit" value="submit">
        </div>
    </div>
  

<script>
    var userData =[]
        function Valuestaking1(element) {
            var FruitData = []

            var row = $(element).closest('tr');
            var td1 = row.find('td').eq(0).find('select').val(); 
            var td2 = row.find('td').eq(1).find('input').val();
            var td3 = row.find('td').eq(2).find('input').val();
            var taotal = parseInt(td2)* parseInt(td3)
            var td4 = row.find('td').eq(3).find('input').val(taotal)
            var dynamic = document.querySelectorAll('.Dynamic')
            var rowData  = {}
            dynamic.forEach(function(element)
            {
                
                var name = element.name;
                var value = element.value
                rowData[name] =value
                
            })

            // FruitData.push(rowData)
            // console.log(FruitData)

            
        }

        $(document).ready(function() {
            $('#DynamicGenerate').on('click', function() {
                var row = $('<tr>');
                row.append('<td><select class="Dynamic" name="fruitName"> <option value="Apple" id="Apple">Apple</option> <option value="Banana" id="Banana">Banana</option></select> </td>');
                row.append('<td><input type="text" name="rate" class="Dynamic"></td>');
                row.append('<td><input type="text" name="Quantity" class="Dynamic"></td>');
                row.append('<td><input type="text" name="Total" class="Dynamic" onblur="Valuestaking1(this)"></td>');
                row.append('<td><input type="button" name="DeleteDynamic" value="Delete" class="DeleteDynamic"></td>');
                $('#FruitDynamic').append(row);
            });
            $(document).on('click','#showPopup',function()
            {
                $('#popup').css({"z-index":"1","opacity":"1","display":"block"});
            })
            $(document).on('click','#submit',function(e)
            {
                var rowData = {}
                e.preventDefault();
                var firstname =$('#firstname').val();
                rowData['firstname']= firstname
                debugger
                var dynamic = document.querySelectorAll('.Dynamic')
                var FruitDataArray =[]
                for(var i=0;i<dynamic.length;i=i+4)
                {
                    var FruitDataObject ={}
                    for(var j=0;j<4;j++)
                    {
                        var element = dynamic[i+j]
                        var name = element.name;
                        var value = element.value
                        FruitDataObject[name] = value
                    }
                    FruitDataArray.push(FruitDataObject)
                }
                rowData['FruitDataArray'] = FruitDataArray

                userData.push(rowData)
                console.log(userData)

            })
            
        });
    </script>

</body>
</html>