<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.0/css/dataTables.dataTables.css" />
    <script src="https://cdn.datatables.net/2.0.0/js/dataTables.js"></script>
    <style>
        .LinkButton {
            background-color: white;
            border: none;
            list-style: none;
            list-style-type: none;
        }

        .popupcity {
            z-index: -1;
            opacity: 1;
            display: none;
        }

        #SchoolPopup {
            z-index: -1;
            opacity: 1;
            display: none;
        }

        #StudentPopup {
            z-index: -1;
            opacity: 1;
            display: none;
        }
    </style>
</head>

<body>
    <form id="Myform">
        <div class="container">
            <ul id="ulData">
                <li><input type="button" name="city" id="city" value="city" class="LinkButton"></li>
                <li><input type="button" name="School" id="School" value="School" class="LinkButton"></li>
                <li><input type="button" name="Student" id="Student" value="Student" class="LinkButton"></li>
            </ul>
            <div id="cityPopup" class="popupcity">
                <form id="CityForm">
                    <div class="row">
                        <div class="col-lg-12">
                            <label>Country</label>
                            <input type="text" name="CountryInput" id="CountryInput" class="form-control">
                        </div><br>
                        <div class="col-lg-12">
                            <label>State</label>
                            <input type="text" name="State" id="State" class="form-control">
                        </div><br>
                        <div class="col-lg-12">
                            <label>City</label>
                            <input type="text" name="City" id="City" class="form-control">
                        </div><br>
                        <div><br>
                            <input type="button" name="submit" id="SubmitCity" class="btn btn-primary" value="submit">
                            <input type="button" name="close" id="closeCity" class="btn btn-danger" value="close">
                            <input type="button" name="UpdateCity" id="UpdateCity" class="btn btn-primary"
                                value="UpdateCity">
                        </div>
                    </div>
                </form>
            </div>
            <div id="SchoolPopup">
                <form id="SchoolForm">
                    <div class="row">
                        <div class="col-lg-12">
                            <label>School Name</label>
                            <input type="text" name="School_Name" id="SchoolName" class="form-control">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <label>SchoolAddress</label>
                            <input type="text" name="SchoolAddress" id="SchoolAddress" class="form-control">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <label>Contact</label>
                            <input type="text" name="Contact" id="Contact" class="form-control">
                        </div>
                    </div>
                    <div><br>
                        <input type="button" name="submit" id="SubmitSchool" class="btn btn-primary" value="submit">
                        <input type="button" name="close" id="closeSchool" class="btn btn-danger" value="close">
                        <input type="button" name="updateSchool" id="updateSchool" class="btn btn-success"
                            value="updateSchool">
                    </div>
                </form>
            </div>
            <div id="StudentPopup">
                <form id="StudentForm">
                    <div class="row">
                        <div class="col-lg-12">
                            <label>Student Name</label>
                            <input type="text" name="StudentName" id="StudentName" class="form-control">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-12">
                            <label>Address</label>
                            <input type="text" name="Address" id="Address" class="form-control">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <label>Country</label>
                            <select class="form-select" id="CountryDropdown">
                                <option>Select Country</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <label>State</label>
                            <select class="form-select" id="StateDropdown">
                                <option>Select State</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <label>Select City</label>
                            <select class="form-select" id="CityDropDown">
                                <option>Select City</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label>School</label>
                            <select class="form-select">
                                <option>Select School</option>
                            </select>
                        </div>
                    </div>
                    <div><br>
                        <input type="button" name="submit" id="SubmitStudent" class="btn btn-primary" value="submit">
                        <input type="button" name="close" id="closeStudent" class="btn btn-danger" value="close">
                    </div>
                </form>
            </div>
            <div>
                <table id="TableCity">
                    <thead>
                        <tr>
                            <th>Country</th>
                            <th>State</th>
                            <th>City</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
            <div>
                <table id="SchoolTable">
                    <thead>
                        <tr>
                            <th>SchoolName</th>
                            <th>SchoolAddress</th>
                            <th>Contact</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </form>
    <script>
        var CityList = [];
        var CityCounter = 0;
        var SchoolList = [];
        var SchoolCounter = 0;
        var SchoolTable = $('#SchoolTable').DataTable();
        var tableCity = $('#TableCity').DataTable();
        $(document).ready(function () {
            $('#city').on('click', function () {
                $('#cityPopup').toggle();
                $('#ulData').toggle();
            })
            $('#School').on('click', function () {
                $('#SchoolPopup').toggle();
                $('#ulData').toggle();
            })
            $('#Student').on('click', function () {
                $('#StudentPopup').toggle();
                $('#ulData').toggle();
            })
            $('#closeStudent').on('click', function () {
                $('#StudentPopup').toggle();
                $('#ulData').toggle();
                $('.dynamic').remove();

            })
            $('#closeSchool').on('click', function () {
                $('#SchoolPopup').toggle();
                $('#ulData').toggle();
            });
            $('#closeCity').on('click', function () {
                $('#cityPopup').toggle();
                $('#ulData').toggle();
            })

            $(document).on('click', '#SubmitCity', function (e) {
                debugger
                e.preventDefault();
                alert();
                var CityData = {};
                var CountryName = $('#CountryInput').val();
                var State = $('#State').val();
                var City = $('#City').val();
                CityData = {
                    Country: CountryName,
                    State: State,
                    City: City,
                    CityCounter: CityCounter

                }
                CityList.push(CityData)
                CityCounter++;
                tableCountry()
                var CountryName = $('#CountryInput').val(" ");
                var State = $('#State').val(" ");
                var City = $('#City').val(" ");
            })
            function tableCountry() {
                tableCity.clear().draw();
                $.each(CityList, function (index, object) {
                    var row1 = tableCity.row.add([object.Country, object.State, object.City, '<input type="button" name="Edit" value="Edit" class="btn btn-primary editCity"><input type="button" name="Delete" value="Delete" class="btn btn-danger">']).draw().node();
                    $(row1).attr('CityCounter', object.CityCounter);
                })
            }
            $(document).on('click', '.editCity', function () {
                var FindCityClick = $(this).closest('tr').attr('CityCounter');
                var FindIndexOfCity = CityList.findIndex(function (element) {
                    return element.CityCounter == FindCityClick;
                });
                $('#CountryInput').val(CityList[FindIndexOfCity].Country)
                $('#State').val(CityList[FindIndexOfCity].State)
                $('#City').val(CityList[FindIndexOfCity].City)
                console.log(CityList[FindIndexOfCity]);

                $(document).on('click', '#UpdateCity', function () {
                    var CityCounter = CityList[FindIndexOfCity].CityCounter;
                    var CountryName = $('#CountryInput').val();
                    var State = $('#State').val();
                    var City = $('#City').val();
                    var newData = {
                        Country: CountryName,
                        State: State,
                        City: City,
                        CityCounter: CityCounter
                    }
                    CityList[FindIndexOfCity] = newData;
                    tableCountry();
                })

            })
            $('#SchoolForm').on('click', '#SubmitSchool', function (e) {
                e.preventDefault();
                var SchoolName = $('#SchoolName').val();
                var SchoolAddress = $('#SchoolAddress').val();
                var Contact = $('#Contact').val();


                var School = {
                    SchoolName: SchoolName,
                    SchoolAddress: SchoolAddress,
                    Contact: Contact,
                    SchoolCounter: SchoolCounter
                }
                SchoolList.push(School);
                SchoolCounter++;
                SchoolTable5();
                $('#SchoolName').val(" ");
                $('#SchoolAddress').val(" ");
                $('#Contact').val(" ");

            })
            function SchoolTable5() {
                SchoolTable.clear().draw();
                $.each(SchoolList, function (index, object) {
                    var row = SchoolTable.row.add([object.SchoolName, object.SchoolAddress, object.Contact, '<input type="button" class="EditSchool btn btn-primary" value="EditSchool"><input type="button" name="DeleteSchool " value="DeleteSchool" class="btn btn-danger DeleteSchool">']).draw().node();
                    $(row).attr('SchoolCounter', object.SchoolCounter)
                });
            }

            $(document).on('click', '.EditSchool', function () {
                var FindSchoolAttr = $(this).closest('tr').attr('SchoolCounter');
                var FindIndexSchool = SchoolList.findIndex(function (element) {
                    return element.SchoolCounter == FindSchoolAttr;
                });

                $('#SchoolName').val(SchoolList[FindIndexSchool].SchoolName);
                $('#SchoolAddress').val(SchoolList[FindIndexSchool].SchoolAddress);
                $('#Contact').val(SchoolList[FindIndexSchool].Contact);

                $(document).on('click', '#updateSchool', function () {
                    var SchoolName = $('#SchoolName').val();
                    var SchoolAddress = $('#SchoolAddress').val();
                    var Contact = $('#Contact').val();
                    var SchoolCounter = SchoolList[FindIndexSchool].SchoolCounter;

                    var NewSchoolData = {
                        SchoolName: SchoolName,
                        SchoolAddress: SchoolAddress,
                        Contact: Contact,
                        SchoolCounter: SchoolCounter
                    }

                    SchoolList[FindIndexSchool] = NewSchoolData;
                    SchoolTable5();
                })
            });
            $(document).on('click', '#SubmitStudent', function (e) {
                e.preventDefault();
                var StudentName = $('#StudentName').val();
                var Address = $('#Address').val();

            });
            $('#CountryDropdown').click(function () {
                if ($('#CountryDropdown option').length == 1) {
                    CityList.forEach(element => {
                        var countryColumn = element.Country;
                        var Options = $('<option>').attr({ "value": countryColumn, "id": countryColumn, "class": "dynamic" })
                        Options.text(countryColumn)
                        $('#CountryDropdown').append(Options);
                    });
                }

            })
            $('#CountryDropdown').change(function () {
                $('#StateDropdown').html('<option>Select State</option>')
                var CountryDropdown = $('#CountryDropdown').val();
                var State = CityList.filter(m => m.Country == CountryDropdown)
                State.forEach(element => {
                    var StateName = element.State;
                    var Option = $('<option>').attr({ "value": element.State, "id": element.State });
                    Option.text(element.State)
                    $('#StateDropdown').append(Option)
                })
            })

            $('#StateDropdown').change(function () {
                var State = $('#StateDropdown').val();
                $('#CityDropDown').html('<option>Select State</option>')
                var City = CityList.filter(m=>m.State==State);
                
                console.log(City)

                City.forEach(element=>
                {
                    var city = element.City;
                    var options1 = $('<option>').attr({"id":city,"value":city})
                        options1.text(city)
                    $('#CityDropDown').append(options1)

                })

            })
            $('')

        })

    </script>
</body>

</html>