<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.0/css/dataTables.dataTables.css" />
    <script src="https://cdn.datatables.net/2.0.0/js/dataTables.js"></script>
</head>

<body>
    <form id="myform">
        <div>
            <label>FirstName</label>
            <input type="text" name="FirstName" id="FirstName"><br>
            <span id="errorFirstName"></span>
        </div>
        <div>
            <label>LastName</label>
            <input type="text" name="LastName" id="LastName">
        </div>
        <div>
            <label>Gender</label>
            <label>Male</label>
            <input type="radio" name="Gender" id="Male" value="male">
            <label>Female</label>
            <input type="radio" name="Gender" id="Female" value="Female">
            <label>TransGender</label>
            <input type="radio" name="Gender" id="TransGender" value="TransGender">
            <label>CreatingTheDropDown</label>
            <input type="text" name="CreatingTheDropDown" id="CreatingTheDropDown">
            <input type="button" name="CreatingTheDropDown" id="CreatingTheDropDown1" value="CreatingTheDropDown">
            <select id="Select1">
                <option value="Select">Select</option>
                <option value="Abhishek1" id="Abhishek1">Abhishek1</option>
                <option value="Abhishek2" id="Abhishek2">Abhishek2</option>
                <option value="Abhishek2" id="Abhishek3">Abhishek3</option>
            </select>
            <input type="button" name="DynamicGroupCreation" id="DynamicGroupCreation" value="DynamicGroupCreation">
            <div id="DynamicGroup">

            </div>
        </div>
        <div><input type="submit" name="submit" id="submit" value="submit"></div>
        <div><input type="button" name="Update" id="Update" value="Update"></div>

        <table id="tableset">
            <thead>
                <tr>
                    <th>FirstName</th>
                    <th>LastName</th>
                    <th>Gender</th>
                    <th>DropDownValue</th>
                    <th>Action</th>
                </tr>
            </thead>
        </table>
        <select id="SelectSecond">
            <option>Select</option>
        </select>
    </form>
    <script>




        var counter = 0;
        var userData = [];
        var counter2 = 0;
        var table = $('#tableset').DataTable();
        $(document).ready(function () {
            $('#DynamicGroupCreation').on('click', function () {
                var input = $('<input>').attr({ "type": "text", "id": "dynamic" + counter, "class": "Dynamic" });
                var div = $('#DynamicGroup')
                div.append(input);
                counter++;
                abhishek()
            });
            $('#CreatingTheDropDown1').on('click', function () {
                debugger
                var data = $('#CreatingTheDropDown').val();
                console.log(data)
                var option = $('<option>').attr({ "value": data, "id": data });
                option.text(data)
                $('#Select1').append(option);
            });


            $('#myform').on('click', '#submit', function (e) {


                var rowData = {};
                e.preventDefault();
                var a = validation();
                if (a == true) {
                    var FirstName = $('#FirstName').val();
                    var LastName = $('#LastName').val();
                    var Gender = document.querySelectorAll('input[name="Gender"]');
                    var GenderValue;
                    for (var i = 0; i < Gender.length; i++) {
                        if (Gender[i].checked) {
                            GenderValue = Gender[i].value;
                        }
                    }

                    var Dropdown = document.getElementById('Select1')
                    var Value = Dropdown.options[Dropdown.selectedIndex].value;
                    document.querySelectorAll('.Dynamic').forEach(function (element) {

                        var id = element.id;
                        var value = element.value;
                        rowData[id] = value;
                    })
                    rowData['FirstName'] = FirstName;
                    rowData['LastName'] = LastName;
                    rowData['Gender'] = GenderValue;
                    rowData['DropDownValue'] = Value;
                    rowData['counter2'] = counter2
                    userData.push(rowData)
                    counter2++;

                    $('#myform')[0].reset();
                    table1();
                    $('.Dynamic').remove();
                    counter = 0;

                }

            });
            function table1() {
                table.clear().draw();
                $.each(userData, function (index, object) {
                    var row = table.row.add([object.FirstName, object.LastName, object.Gender, object.DropDownValue, '<input type="button" name="Edit" value="Edit" class="Edit"><input type="button" name="Delete" value ="Delete">']).draw().node();
                    $(row).attr('counter2', object.counter2);
                })
            }
            $(document).on('click', '.Edit', function () {
                var counter4 = 1;
                var RowFindAttr = $(this).closest('tr').attr('counter2')
                var FindValue = userData.findIndex(function (element) {
                    return element.counter2 == RowFindAttr
                })
                var SetValues = userData[FindValue];
                $('#FirstName').val(SetValues.FirstName);
                $('#LastName').val(SetValues.LastName);
                $('input[name="Gender"][value="' + SetValues.Gender + '"]').prop('checked', true);
                $('#Select1').val(SetValues.DropDownValue);
                var ObjectLenght = Object.keys(SetValues).length;

                var actualDynamicCount = ObjectLenght - 5;
                for (var i = 0; i < actualDynamicCount; i++) {
                    $('#DynamicGroupCreation').click();
                }
                document.querySelectorAll('.Dynamic').forEach(function (element) {
                    var id = element.id
                    element.value = SetValues[id];
                });

                $(document).on('click', '#Update', function () {
                    var rowData1 = {};
                    var counter2 = SetValues.counter2; //this is static values which was we assign 
                    var NewValuesFirstName = $('#FirstName').val();
                    var NewValuesLastName = $('#LastName').val();
                    var Gender = document.querySelectorAll('input[name="Gender"]');
                    var GenderValue;
                    for (var i = 0; i < Gender.length; i++) {
                        if (Gender[i].checked) {
                            GenderValue = Gender[i].value;
                        }
                    }
                    var Dropdown = document.getElementById('Select1');
                    var Values = Dropdown.options[Dropdown.selectedIndex].value;

                    document.querySelectorAll('.Dynamic').forEach(function (element) {
                        var id = element.id;
                        var value = element.value;
                        rowData1[id] = value;
                    });
                    rowData1['FirstName'] = NewValuesFirstName;
                    rowData1['LastName'] = NewValuesLastName;
                    rowData1['Gender'] = GenderValue
                    rowData1['DropDownValue'] = Values;
                    rowData1['counter2'] = counter2;
                    userData[FindValue] = rowData1;
                    console.log(userData);
                    table1();

                });
            })

            function validation() {
                var flag = 0;
                var FirstName = $('#FirstName').val();
                var regx = /^[a-zA-Z]+$/;
                if (regx.test(FirstName)&& FirstName.length>3   ) 
                {
                    flag = 0;
                } 
                else 
                {
                    debugger
                    $('#errorFirstName').text("please add the proper name");
                    $('#errorFirstName').css({"color":"red"})
                    flag = 1;
                }
                var LastName = $('#LastName').val();
                var regexLast = /^[a-zA-Z _-](3-10)+$/
                if(regexLast.test(LastName))
                {   
                    flag=0;
                }
                else
                {
                    flag =1
                }
                if (flag == 1) {
                    return false; 
                }
                else {
                    return true;
                }
                
            }
            function abhishek() {
                var a = [{ "Abhishek": "Abhishek", "Pankaj": "Pankaj", "jain": "jain" }, { "Abhishek": "Abhishek1", "Pankaj": "Pankaj2", "jain": "jain2" }]
                $.each(a, function (index, object) {
                    var newOption = $('<option>').attr({ "value": object.Abhishek, "id": object.Pankaj })
                    newOption.text(object.jain);

                    $('#SelectSecond').append(newOption)
                });
            }


        });
    </script>
</body>

</html>